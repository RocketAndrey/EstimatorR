@page
@model Estimator.Pages.CustomerRequests.IndexModel


@{
    ViewData["Title"] = "Заявки";
}
@addTagHelper  *, Estimator


<form asp-page="./Index" method="get">

    <table class="table table-borderless">
        <tr>
            <td>
                <h3>Заявки:</h3>
            </td>
            <td align="right">
                <a asp-page="Create" class="btn btn-outline-primary btn-sm">Создать заявку</a>
            </td>
    </table>

    <table class="table table-bordered">
        <thead>
            <tr class="table-secondary table-sm">
                <th>    @Html.DisplayNameFor(model => model.CustomerRequestList[0].CustomerRequestID)</th>
               
                <th>
                    @Html.DisplayNameFor(model => model.CustomerRequestList[0].RequestNumber)
                </th>
                <th>
                    <a asp-page="./Index" asp-route-sortOrder="@Model.DateSort"
                       asp-route-currentFilter="@Model.CurrentFilter">

                        @Html.DisplayNameFor(model => model.CustomerRequestList[0].RequestDate)
                    </a>
                </th>
                <th>
                    @Html.DisplayNameFor(model => model.CustomerRequestList[0].Description)
                </th>
                <th>
                    <a asp-page="./Index" asp-route-sortOrder="@Model.ProgramSort"
                       asp-route-currentFilter="@Model.CurrentFilter">

                        @Html.DisplayNameFor(model => model.CustomerRequestList[0].ProgramName)
                    </a>
                </th>
                <th>
                    <a asp-page="./Index" asp-route-sortOrder="@Model.CustomerSort"
                       asp-route-currentFilter="@Model.CurrentFilter">

                        @Html.DisplayNameFor(model => model.CustomerRequestList[0].CustomerName)
                    </a>
                </th>
                <th></th>
            </tr>
        </thead>
        <tbody>
            <tr class="table-secondary table-sm">
                <td width="100">
                    <input class="form-control form-control-sm" type="text" name="customerRequestID" value="@Model.filter.CustomerRequestID" />
                </td>
               
                <td>
                </td>
                <td>
                </td>
                <td>
                    <input class="form-control form-control-sm" type="text" name="SearchString" value="@Model.CurrentFilter" />
                </td>
                <td>
                    <select class="form-control form-control-sm" asp-for="@Model.filter.ProgramID" name="programID" class="form-control" asp-items="ViewBag.TestProgramID"></select>
                </td>
                <td>
                    <select class="form-control form-control-sm"  asp-for="@Model.filter.CustomerID" name="customerID" class="form-control" asp-items="ViewBag.CustomerID"></select>

                </td>
                <td>
                    <input type="submit" value="Поиск" class="btn btn-outline-primary btn-sm " />
                </td>
            </tr>
            @foreach (var item in Model.CustomerRequestList)
            {
                <tr>

                    <td>
                        <div class="form-row">
                            <a asp-page="./Edit" asp-route-id="@item.CustomerRequestID"> @Html.DisplayFor(modelItem => item.CustomerRequestID)</a>&nbsp;

                   
                        <a asp-page="./Report" asp-route-id="@item.CustomerRequestID"><img src="~/contract2.png" width="20" height="20" /></a>
                        @if (item.UseImport)
                        {
                            <a asp-page="./Import" asp-route-id="@item.CustomerRequestID"><img src="~/xlsx.png" width="20" height="20" /></a>
                        }

                        </div>
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.RequestNumber)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.RequestDate)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.Description)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.ProgramName)
                    </td>
                    <td>
                        <!-- @Html.DisplayFor(modelItem => item.CustomerName)-->
                        <a href=@String.Concat("https://www.rusprofile.ru/search?query=",item.CustomerINN) target="_blank">@Html.DisplayFor(modelItem => item.CustomerName)</a>
                    </td>
                    <td>

                        <a asp-page="./Delete" asp-route-id="@item.CustomerRequestID"><img src="~/delete.png" /></a>

                    </td>
                </tr>
            }
        </tbody>
    </table>
</form>
@{
    var prevDisabled = !Model.CustomerRequestList.HasPreviousPage ? "disabled" : "";
    var nextDisabled = !Model.CustomerRequestList.HasNextPage ? "disabled" : "";
}


@*<a asp-page="./Index"
   asp-route-sortOrder="@Model.CurrentSort"
   asp-route-pageIndex="@(Model.CustomerRequestList.PageIndex - 1)"
   asp-route-currentFilter="@Model.CurrentFilter"
   class="btn btn-outline-primary  @prevDisabled">
    Назад
</a>
<a asp-page="./Index"
   asp-route-sortOrder="@Model.CurrentSort"
   asp-route-pageIndex="@(Model.CustomerRequestList.PageIndex + 1)"
   asp-route-currentFilter="@Model.CurrentFilter"
   class="btn btn-outline-primary @nextDisabled">
    Вперед
</a>*@
<page-link page-model="Model.CustomerRequestList"
           page-url-pageIndex="@(Model.CustomerRequestList.PageIndex - 1)"
           page-url-currentFilter="@(Model.CurrentFilter)"
           page-url-sortorder="@(Model.CurrentSort)"></page-link>